= form_tag(reports_path, method: :post, id: 'generate_form') do
  = hidden_field_tag :name, report.name
  = hidden_field_tag :queued_at, Time.now
  = hidden_field_tag :state, 'NEW'
  = hidden_field_tag :mime_type, report.mime_type
  = hidden_field_tag :dsn, report.dsn
  = hidden_field_tag :db_unit, report.db_unit
  = hidden_field_tag :batch_size, report.batch_size
  = hidden_field_tag :msg_model, report.msg_model
  = hidden_field_tag :file_ext, report.file_ext
  - if report.params_cnt.present? and report.params_cnt > 0
    - (1..report.params_cnt).each do |i|
      = label_tag report["param#{i}"]["param#{i}_name"] || "Parameter #{i}"
      = send("#{report["param#{i}"]["param#{i}_type"] || 'text'}_field_tag", "param#{i}_value")
      = hidden_field_tag "param#{i}_type", report.send("param#{i}_type")
      = hidden_field_tag "param#{i}_name", report.send("param#{i}_name")
  %div
  = submit_tag 'Generate'
